{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">🕘 Historial de Cambios</h2>

  <h4>📍 Indicador:</h4>
  <p class="fw-bold">{{ tablero.indicador }}</p>

  <div class="row">
    <div class="col-md-6">
      <h5>📜 Cambios de campos</h5>
      {% if historial %}
        <ul class="list-group mb-4">
          {% for cambio in historial %}
            <li class="list-group-item">
              <strong>{{ cambio.fecha|date:"Y-m-d H:i" }}</strong> – 
              {{ cambio.usuario }} modificó <strong>{{ cambio.campo }}</strong>: 
              <em>{{ cambio.valor_anterior }}</em> → <em>{{ cambio.valor_nuevo }}</em>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay cambios registrados en campos.</p>
      {% endif %}
    </div>

    <div class="col-md-6">
      <h5>📈 Cambios de Avance</h5>
      {% if historial_avances %}
        <ul class="list-group">
          {% for ha in historial_avances %}
            <li class="list-group-item">
              <strong>{{ ha.fecha|date:"Y-m-d H:i" }}</strong> – 
              {{ ha.usuario }} cambió avance: 
              <em>{{ ha.avance_anterior }}</em> → <em>{{ ha.avance_nuevo }}</em>
              {% if ha.observacion %}
                <br><small>📝 Observación: {{ ha.observacion }}</small>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay registros de avance.</p>
      {% endif %}
    </div>
  </div>

  <div class="mt-3">
    <a href="{% url 'lista_tablero' %}" class="btn btn-secondary">↩️ Volver</a>
  </div>
</div>
{% endblock %}
