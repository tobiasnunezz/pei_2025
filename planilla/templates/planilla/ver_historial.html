{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h4>üìú Historial de cambios para: <strong>{{ tablero.indicador }}</strong></h4>

  {% if historial or historial_avances %}
    <h5 class="mt-4">üïì Cambios T√©cnicos Registrados</h5>
    {% if historial %}
    <table class="table table-sm table-bordered mt-3">
      <thead class="table-light">
        <tr>
          <th>Fecha</th>
          <th>Campo</th>
          <th>Valor anterior</th>
          <th>Valor nuevo</th>
          <th>Usuario</th>
        </tr>
      </thead>
      <tbody>
        {% for cambio in historial %}
        <tr>
          <td>{{ cambio.fecha|date:"d/m/Y H:i" }}</td>
          <td>{{ cambio.campo }}</td>
          <td>{{ cambio.valor_anterior }}</td>
          <td>{{ cambio.valor_nuevo }}</td>
          <td>{{ cambio.usuario.username }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="text-muted">No se registraron cambios t√©cnicos.</p>
    {% endif %}

    <h5 class="mt-4">‚úçÔ∏è Modificaciones de Avance / Observaci√≥n</h5>
    {% if historial_avances %}
    <table class="table table-sm table-bordered mt-3">
      <thead class="table-light">
        <tr>
          <th>Fecha</th>
          <th>Avance anterior</th>
          <th>Avance nuevo</th>
          <th>Observaci√≥n</th>
          <th>Usuario</th>
        </tr>
      </thead>
      <tbody>
        {% for registro in historial_avances %}
        <tr>
          <td>{{ registro.fecha|date:"d/m/Y H:i" }}</td>
          <td>{{ registro.avance_anterior }}</td>
          <td>{{ registro.avance_nuevo }}</td>
          <td>{{ registro.observacion|default:"-" }}</td>
          <td>{{ registro.usuario.username }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="text-muted">No se registraron modificaciones de avance u observaci√≥n.</p>
    {% endif %}

  {% else %}
    <p class="text-muted mt-4">No hay cambios registrados para este indicador.</p>
  {% endif %}

  <a href="{% url 'lista_tablero' %}" class="btn btn-secondary mt-3">‚¨ÖÔ∏è Volver</a>
</div>
{% endblock %}
