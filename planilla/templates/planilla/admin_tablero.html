{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-4 text-center fw-bold text-uppercase">ðŸ›  GestiÃ³n del Tablero (Administrador)</h2>
  <div class="table-responsive">
    <table class="table table-bordered align-middle text-center">
      <thead class="table-dark">
        <tr>
          <th style="width: 40px;">NÂ°</th>
          <th>EJE ESTRATÃ‰GICO</th>
          <th>OBJETIVO ESTRATÃ‰GICO</th>
          <th>INDICADOR</th>
          <th>META 2025</th>
          <th>AVANCE</th>
          <th>NIVEL</th>
          <th>ACCIÃ“N</th>
          <th>RESPONSABLE</th>
          <th>EDITAR</th>
        </tr>
      </thead>
      <tbody>
        {% for eje, objetivos in agrupado.items %}
          {% for objetivo, items in objetivos.items %}
            {% for item in items %}
            <tr>
              {% if forloop.first and forloop.parentloop.first %}
                <td rowspan="{{ items|length }}">{{ forloop.parentloop.counter }}</td>
                <td rowspan="{{ items|length }}"><strong>{{ eje }}</strong></td>
                <td rowspan="{{ items|length }}">{{ objetivo }}</td>
              {% elif forloop.first %}
                <td rowspan="{{ items|length }}">{{ forloop.parentloop.counter }}</td>
                <td rowspan="{{ items|length }}"><strong>{{ eje }}</strong></td>
                <td rowspan="{{ items|length }}">{{ objetivo }}</td>
              {% endif %}
              <td>{{ item.indicador|default_if_none:"" }}</td>
              <td>{{ item.meta_2025|default_if_none:"" }}</td>
              <td>{{ item.avance|default_if_none:"" }}</td>
              <td>
                {% if item.nivel == "Bajo" %}
                  <span class="badge bg-danger">Bajo</span>
                {% elif item.nivel == "Medio" %}
                  <span class="badge bg-warning text-dark">Medio</span>
                {% elif item.nivel == "Alto" %}
                  <span class="badge bg-success">Alto</span>
                {% else %}
                  â€”
                {% endif %}
              </td>
              <td>{{ item.accion|default_if_none:"" }}</td>
              <td>{{ item.responsable|default_if_none:"" }}</td>
              <td>
                <a href="{% url 'editar_avance' item.id %}" class="btn btn-sm btn-outline-primary">Editar</a>
              </td>
            </tr>
            {% endfor %}
          {% endfor %}
        {% empty %}
          <tr>
            <td colspan="10">No hay datos disponibles.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
